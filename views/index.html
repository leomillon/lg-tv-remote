{% extends 'layout.html' %}

{% block content %}
    <div class="row">
        <div class="col-xs-12">
            <h1>{{ title }}</h1>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-12">
            <button id="discovery-button" type="button" class="btn btn-default">Discover devices</button>
        </div>
    </div>
    <div class="row" id="device-list-container">
        <div class="col-xs-12">
            <ul id="device-list">

            </ul>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    {% parent %}
    <script>
        $(function () {
            $('#discovery-button').on('click', function () {
                $.ajax({
                    url: '/tv-api/discovery'
                })
                .done(function (devices) {
                    console.log('Devices :', devices);
                    var deviceListElement = $('#device-list');
                    deviceListElement.empty();
                    _.each(devices, function (device) {
                        deviceListElement.append('<li><p>[' + device.type + '] ' + device.name + '<br>' +
                                '<small>' + device.uuid + '</small></p></li>');
                    });
                });
            });
        });
    </script>
{% endblock %}