{% extends 'layout.html' %}

{% block content %}
    <h1>{{ title }}</h1>
    <div>
        <button type="button" id="discovery-button">Discover devices</button>
    </div>
    <div id="device-list-container">
        <ul id="device-list">

        </ul>
    </div>
{% endblock %}

{% block scripts %}
    {% parent %}
    <script>
        $(function () {
            $('#discovery-button').on('click', function () {
                $.ajax({
                    url: '/tv-api/discovery'
                })
                .done(function (devices) {
                    console.log('Devices :', devices);
                    var deviceListElement = $('#device-list');
                    deviceListElement.empty();
                    _.each(devices, function (device) {
                        deviceListElement.append('<li><p>[' + device.type + '] ' + device.name + '<br>' +
                                '<small>' + device.uuid + '</small></p></li>');
                    });
                });
            });
        });
    </script>
{% endblock %}